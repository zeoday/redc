# 本地模板页面改进 - 支持显示和编辑所有类型模板

## 概述

本次修改使本地模板页面能够显示并编辑所有4种类型的模板，包括之前被过滤掉的自定义模板、Userdata模板和Compose模板。

## 背景：4种模板类型

redc系统中存在4种类型的模板：

| 类型 | 目录 | case.json 标记 | 用途 |
|------|------|----------------|------|
| 预定义模板 | `aliyun/`, `aws/`, `huaweicloud/`, `tencent/` | 无标记 | 场景管理页面使用 |
| 自定义模板 | `base-templates/` | `is_base_template: true` | 自定义部署使用 |
| Userdata模板 | `userdata-templates/` | `is_userdata_template: true` | 自定义部署和专项场景使用 |
| Compose模板 | `compose-templates/` | `is_compose_template: true` | 编排管理使用 |

## 修改内容

### 1. 后端修改

#### mod/tmpl.go

添加了 `ListAllTemplates()` 函数，返回所有模板（包括之前被过滤的自定义、userdata、compose模板）：

```go
// ListAllTemplates 返回所有模板，包括自定义模板、userdata模板和compose模板
func ListAllTemplates() ([]*RedcTmpl, error) {
    // ... 扫描所有模板目录，不进行过滤
}
```

#### app.go

1. 添加了 `ListAllTemplates()` API 端点：

```go
func (a *App) ListAllTemplates() ([]TemplateInfo, error) {
    templates, err := redc.ListAllTemplates()
    // ...
}
```

2. 修改了 `GetTemplateFiles()` 函数，支持读取更多文件类型：

```go
// 支持读取的文件类型
if name == "case.json" || name == "terraform.tfvars" || 
   strings.HasSuffix(name, ".tf") ||
   strings.HasSuffix(name, ".yaml") || strings.HasSuffix(name, ".yml") ||
   strings.HasSuffix(name, ".sh") || strings.HasSuffix(name, ".userdata") ||
   name == "userdata" || name == "script.sh" {
    // ...
}
```

3. 修改了 `SaveTemplateFiles()` 函数，支持保存更多文件类型（与GetTemplateFiles保持一致）。

### 2. 前端修改

#### frontend/src/components/LocalTemplates/LocalTemplates.svelte

将 `ListTemplates` 替换为 `ListAllTemplates`：

```javascript
import { ListAllTemplates, ... } from '../../../wailsjs/go/main/App.js';

// 在 loadLocalTemplates 函数中
localTemplates = await ListAllTemplates() || [];
```

## 页面行为

- **本地模板页面**：显示所有4种类型的模板，可编辑所有相关文件
- **场景管理页面**：保持原有行为，只显示预定义模板（使用 `ListTemplates()` API）

## 相关文件

- `mod/tmpl.go` - 添加 ListAllTemplates 函数
- `app.go` - 添加 ListAllTemplates API，修改 GetTemplateFiles/SaveTemplateFiles
- `frontend/src/components/LocalTemplates/LocalTemplates.svelte` - 使用 ListAllTemplates
- `frontend/wailsjs/go/main/App.js` - 自动生成的 JS 绑定
